Based on https://www.scs.stanford.edu/17au-cs244b/labs/projects/kislyuk_zhai.pdf
